<view class="container">
  <image src="/assets/images/component/button.svg" style="width:0;height:0;opacity:0;position:absolute;" />
  <!-- 装饰性彩带 -->
  <view class="confetti-container">
    <view class="confetti" wx:for="{{5}}" wx:key="index" style="left: calc(10% + {{index * 20}}%);"></view>
  </view>
  
  <!-- 顶部导航 -->
  <t-navbar 
    title="{{t.navTitle}}" 
    left-arrow="{{false}}"
    title-color="#1F2937"
    t-class="t-navbar"
    fixed
    placeholder
  >
    <view slot="left" class="custom-back-btn" bindtap="goBack">
      <t-icon name="chevron-left" size="48rpx" color="#1F2937" />
    </view>
  </t-navbar>
  
  <!-- 成绩展示 -->
  <view class="result-container mb-large">
    <view class="trophy mb-medium">
      <text class="iconfont icon-magic_star_line" style="font-size: 112rpx; color: #FFF;"></text>
    </view>
    <view class="result-title mb-small">{{t.greatPerformance}}</view>
    <view class="result-desc mb-medium">
      {{t.resultPrefix}}<text class="text-primary font-bold">{{correctRate}}</text>{{t.accuracySuffix}}
    </view>
    
    <view class="stats-container">
      <view class="stat-item">
        <view class="stat-value">{{pointsGained}}</view>
        <view class="stat-label">{{t.statPoints}}</view>
      </view>
      
      <view class="stat-item">
        <view class="stat-value">{{maxCombo}}</view>
        <view class="stat-label">{{t.statCombo}}</view>
      </view>
      
      <view class="stat-item">
        <view class="stat-value">{{percentile}}%</view>
        <view class="stat-label">{{t.statPercentile}}</view>
      </view>
    </view>
  </view>
  
  <!-- 等级进度 -->
  <view class="card level-card mb-medium">
    <view class="flex-between mb-medium">
      <view class="level-title">{{t.yourLevel}}</view>
      <view class="level-badge level-{{levelClass}}">{{level}}</view>
    </view>
    
    <view class="flex-start text-gray mb-small">
      <text class="mr-small">{{totalPoints}}{{t.pointsUnit}}</text>
      <text class="dot mx-small">•</text>
      <text>{{t.distanceTo}}{{nextLevel}}"{{t.needPointsSuffix}}{{pointsToNextLevel}}{{t.pointsUnit}}</text>
    </view>
    
    <view class="progress-bar">
      <view class="progress-bar-fill" style="width: {{levelProgress}}%;"></view>
    </view>
    
    <view class="level-up-notice" wx:if="{{hasLevelUp}}">
      <t-icon name="check-circle" size="40rpx" color="#6366F1" />
      <text class="level-up-text">{{t.levelUpNotice1}}{{level}}{{t.levelUpNotice2}}</text>
    </view>
  </view>
  
  <!-- 分析结果 -->
  <view class="card analysis-card mb-medium">
    <view class="analysis-title mb-medium">{{t.analysisTitle}}</view>
    
    <view class="analysis-desc mb-medium">
      {{analysisResult}}
    </view>
    
    <view class="skill-levels mb-small">
      <view class="skill-level">
        <view class="skill-bar excellent"></view>
        <text class="skill-label">{{t.skillExcellent}}</text>
      </view>
      <view class="skill-level">
        <view class="skill-bar good"></view>
        <text class="skill-label">{{t.skillGood}}</text>
      </view>
      <view class="skill-level">
        <view class="skill-bar average"></view>
        <text class="skill-label">{{t.skillAverage}}</text>
      </view>
      <view class="skill-level">
        <view class="skill-bar weak"></view>
        <text class="skill-label">{{t.skillWeak}}</text>
      </view>
    </view>
    
    <view class="skills-grid">
      <block wx:for="{{skillLevels.excellent}}" wx:key="*this">
        <view class="skill-tag excellent">{{item}}</view>
      </block>
      <block wx:for="{{skillLevels.good}}" wx:key="*this">
        <view class="skill-tag good">{{item}}</view>
      </block>
      <block wx:for="{{skillLevels.average}}" wx:key="*this">
        <view class="skill-tag average">{{item}}</view>
      </block>
      <block wx:for="{{skillLevels.weak}}" wx:key="*this">
        <view class="skill-tag weak">{{item}}</view>
      </block>
    </view>
  </view>
  
  <!-- 分享和再来一轮按钮 -->
  <button class="share-button mb-medium" open-type="share">
    <t-icon name="share" size="40rpx" color="#FFF" class="mr-small" />
    {{t.shareButton}}
  </button>
  
  <button class="full-width-button" bindtap="playAgain">
    {{t.playAgain}}
  </button>
</view> 

<!-- 成就弹窗 -->
<view wx:if="{{showAchievementModal}}" class="modal-overlay" bindtap="closeAchievement">
  <view class="modal-content" bindtap="">
    <view class="modal-badge-wrapper">
      <image class="modal-badge" src="{{achievementIcon}}" mode="aspectFit" />
    </view>
    <view class="modal-title">{{achievementName}}</view>
    <view class="modal-desc">{{achievementDescription}}</view>
    <view class="modal-close-btn" bindtap="closeAchievement">
      <image class="btn-bg" src="/assets/images/component/button.svg" mode="widthFix" />
      <text class="btn-text">{{t.closeLabel}}</text>
    </view>
  </view>
</view> 