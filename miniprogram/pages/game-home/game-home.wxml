<view class="container">
  <!-- 顶部导航 -->
  
  <t-navbar 
    title="{{t.navTitle || '首页'}}" 
    title-color="#ffffff"
    t-class="t-navbar"
    fixed
    placeholder
  />
  
  <!-- 顶部用户信息 -->
  <view class="card user-info-card mb-medium" bindtap="editProfile">
    <view class="flex-start">
      <view class="avatar-wrapper mr-medium">
        <image wx:if="{{avatarUrl}}" class="avatar-img" src="{{avatarUrl}}" mode="aspectFill"></image>
        <view wx:else class="avatar">
          <text class="iconfont icon-a-MATE_huaban1fuben118" style="color:#ffffff;font-size:64rpx;"></text>
        </view>
      </view>
      <view class="flex-1">
        <view class="flex-start mb-small">
          <text class="username mr-small">{{username}}</text>
          <view class="level-badge level-{{levelClass}}">{{level}}</view>
        </view>
        <view class="flex-start text-gray text-sm">
          <text class="mr-small">{{points}}{{t.points}}</text>
          <text class="dot mx-small">•</text>
          <text>{{progressText}}</text>
        </view>
        <view class="progress-bar mt-small">
          <view class="progress-bar-fill" style="width: {{levelProgress + '%'}}"></view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- 游戏模式选择 -->
  <view class="section-title mb-medium">{{t.challengeModes}}</view>
  
  <view class="challenge-modes mb-large">
    <!-- 快速挑战卡片 -->
    <view class="mode-card" bindtap="startQuickChallenge">
      <image class="card-icon" src="/assets/figma/quick_challenge_top.png" mode="widthFix"></image>
      <image class="card-image" src="/assets/images/game-home/quick-challenge.svg" mode="widthFix"></image>
    </view>

    <!-- 困难模式卡片 -->
    <view class="mode-card">
      <image class="card-icon" src="/assets/figma/hard_mode_top.png" mode="widthFix"></image>
      <image class="card-image" src="/assets/images/game-home/hard-mode.svg" mode="widthFix"></image>
    </view>
  </view>
  
  <!-- 排行榜 -->
  <view class="section-title mb-medium">{{t.rankings}}</view>
  
  <view class="card ranking-card">
    <view class="ranking-item" wx:for="{{displayRankings}}" wx:key="index">
      <view class="flex-start">
        <view class="ranking-avatar-wrapper mr-medium">
          <!-- 头像 -->
          <image wx:if="{{item.avatarUrl}}" class="ranking-avatar" src="{{item.avatarUrl}}" mode="aspectFill"></image>
          <view wx:else class="ranking-avatar-fallback">
            <text class="iconfont icon-a-MATE_huaban1fuben118" style="color:#ffffff;font-size:36rpx;"></text>
          </view>
          <!-- 右下角排名徽章/数字 -->
          <block wx:if="{{item.rank <= 3}}">
            <image class="ranking-rank-badge" src="/assets/icons/{{item.rank === 1 ? 'first' : (item.rank === 2 ? 'second' : 'third')}}.png" mode="aspectFit" />
          </block>
          <block wx:else>
            <view class="ranking-rank-number {{item.isUser ? 'you' : ''}}">{{item.rank}}</view>
          </block>
        </view>
        <text class="{{item.isUser ? 'text-primary font-bold' : ''}}">{{item.name}}</text>
      </view>
      <text class="{{item.isUser ? 'text-primary font-bold' : 'font-bold'}}">{{item.points}}{{t.points}}</text>
    </view>
    
    <!-- 展开/收起按钮 -->
    <view class="view-all-button" bindtap="toggleRankings">
      <text>{{showFullRankings ? t.collapse : t.viewAll}}</text>
      <t-icon name="{{showFullRankings ? 'chevron-up' : 'chevron-down'}}" size="32rpx" color="#577CE2" />
    </view>
  </view>
</view> 