<view class="container">
  <!-- 顶部导航 -->
  <t-navbar 
    title="{{t.navTitle}}" 
    title-color="#ffffff"
    t-class="t-navbar"
    fixed
    placeholder
  />
  
    
  
  <!-- 用户信息卡片 -->
  <view class="card user-info-card mb-medium" bindtap="editProfile">
    <view class="flex-start">
      <view class="avatar-wrapper mr-medium">
        <image wx:if="{{avatarUrl}}" class="avatar-img" src="{{avatarUrl}}" mode="aspectFill"></image>
        <view wx:else class="avatar">
          <text class="iconfont icon-a-MATE_huaban1fuben118" style="color:#ffffff;font-size:80rpx;"></text>
        </view>
      </view>
      <view class="flex-1">
        <view class="flex-start mb-small">
          <text class="username mr-small">{{username}}</text>
          <view class="level-badge level-{{levelClass}}">{{level}}</view>
        </view>
        <view class="flex-start text-gray text-sm">
          <text class="mr-small">{{t.challengesCompleted}}{{completedChallenges}}</text>
          <text class="dot mx-small">•</text>
          <text>{{points}}{{t.pointsLabel}}</text>
        </view>
        <view class="progress-bar mt-small">
          <view class="progress-bar-fill" style="width: {{levelProgress + '%'}}"></view>
        </view>
        <view class="text-right text-gray text-xs mt-small">
          {{progressText}}
        </view>
      </view>
    </view>
  </view>
  
  <!-- 统计数据 -->
  <view class="stats-grid mb-medium">
    <view class="stat-card">
      <view class="stat-value">{{correctRate}}%</view>
      <view class="stat-label">{{t.statsCorrectRate}}</view>
    </view>
    
    <view class="stat-card">
      <view class="stat-value">{{maxCombo}}</view>
      <view class="stat-label">{{t.statsMaxCombo}}</view>
    </view>
    
    <view class="stat-card">
      <view class="stat-value">{{unlockedAchievements}}</view>
      <view class="stat-label">{{t.statsAchievements}}</view>
    </view>
  </view>
  
  <!-- 标签页 -->
  <view class="tabs mb-medium">
    <view class="tab {{currentTab === 'achievements' ? 'active' : ''}}" 
          bindtap="switchTab" data-tab="achievements">{{t.tabAchievements}}</view>
    <view class="tab {{currentTab === 'history' ? 'active' : ''}}" 
          bindtap="switchTab" data-tab="history">{{t.tabHistory}}</view>
  </view>
  
  <!-- 成就列表 -->
  <view class="achievements-list" wx:if="{{currentTab === 'achievements'}}">
    <view class="achievement {{achievement.unlocked ? 'unlocked' : 'locked'}}" 
          wx:for="{{achievements}}" wx:key="id" wx:for-item="achievement">
      <view class="achievement-icon {{achievement.unlocked ? 'unlocked' : 'locked'}}">
        <text wx:if="{{achievement.iconType === 'iconfont'}}" class="iconfont icon-{{achievement.icon}}" style="color: {{achievement.unlocked ? '#10B981' : '#9CA3AF'}}; font-size: 48rpx;"></text>
        <t-icon wx:else name="{{achievement.icon}}" size="48rpx" color="{{achievement.unlocked ? '#10B981' : '#9CA3AF'}}" />
      </view>
      <view class="achievement-content">
        <view class="achievement-title">{{achievement.title}}</view>
        <view class="achievement-desc">{{achievement.description}}</view>
      </view>
    </view>
  </view>
  
  <!-- 历史记录 -->
  <view class="history-list" wx:if="{{currentTab === 'history'}}">
    <view class="empty-state" wx:if="{{history.length === 0}}">
      <t-icon name="time" size="96rpx" color="#D1D5DB" />
      <view class="empty-text">{{t.historyEmpty}}</view>
    </view>
    <view class="history-item" wx:for="{{history}}" wx:key="id">
      <view class="history-content">
        <view class="history-title">{{t.historyChallenge}} {{item.id}}</view>
        <view class="history-stats">
          <text>{{t.historyCorrectRate}}: {{item.correctRate}}%</text>
          <text class="dot mx-small">•</text>
          <text>{{t.historyPointsGained}} {{item.pointsGained}}{{t.pointsLabel}}</text>
        </view>
      </view>
      <view class="history-score {{item.correctRate >= 70 ? 'good' : (item.correctRate >= 50 ? 'average' : 'poor')}}">
        {{item.correctRate}}%
      </view>
    </view>
  </view>
</view> 